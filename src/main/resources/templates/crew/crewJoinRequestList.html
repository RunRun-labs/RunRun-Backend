<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>크루 알림 - 런런</title>
    <link rel="preconnect" href="https://fonts.googleapis.com"/>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fugaz+One&display=swap"
        rel="stylesheet"
    />
    <link rel="stylesheet" th:href="@{/css/crew/crewJoinRequestList.css}">
</head>
<body>
<div class="container">
    <!-- 헤더 -->
    <header class="header">
        <button type="button" class="btn-back" onclick="history.back()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round"/>
            </svg>
        </button>
        <h1 class="header-title">크루 알림</h1>
    </header>

    <!-- 승인 대기 서브헤더 -->
    <div class="sub-header">
        <span class="sub-header__label">승인 대기</span>
        <span class="sub-header__count" id="pendingCount">0명</span>
    </div>

    <!-- 메인 컨텐츠 -->
    <main class="main-content">
        <!-- 가입 신청 목록 -->
        <section class="join-request-list" id="joinRequestList">
            <!-- Thymeleaf로 초기 데이터 렌더링 -->
            <article th:each="request : ${joinRequests}" class="join-request-card"
                     th:data-request-id="${request.joinRequestId}">
                <div class="join-request-card__profile">
                    <img th:src="${request.userProfileImageUrl ?: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGNpcmNsZSBjeD0iMzAiIGN5PSIzMCIgcj0iMzAiIGZpbGw9IiNGNUY1RjUiLz48Y2lyY2xlIGN4PSIzMCIgY3k9IjI1IiByPSI4IiBmaWxsPSIjOTk5Ii8+PHBhdGggZD0iTTEwIDQwQzEwIDM1IDE1IDMwIDIwIDMwSDQwQzQ1IDMwIDUwIDM1IDUwIDQwIiBmaWxsPSIjOTk5Ii8+PC9zdmc+'}"
                         alt="프로필"
                         class="join-request-card__profile-image"
                         onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGNpcmNsZSBjeD0iMzAiIGN5PSIzMCIgcj0iMzAiIGZpbGw9IiNGNUY1RjUiLz48Y2lyY2xlIGN4PSIzMCIgY3k9IjI1IiByPSI4IiBmaWxsPSIjOTk5Ii8+PHBhdGggZD0iTTEwIDQwQzEwIDM1IDE1IDMwIDIwIDMwSDQwQzQ1IDMwIDUwIDM1IDUwIDQwIiBmaWxsPSIjOTk5Ii8+PC9zdmc+'">
                    <p class="join-request-card__name" th:text="${request.userName}">러너 1</p>
                    <p class="join-request-card__date" th:text="${#temporals.format(request.createdAt, 'yyyy.MM.dd')}">
                        2025.10.19</p>
                </div>
                <div class="join-request-card__message">
                    <p th:text="${request.introduction ?: '자기소개가 없습니다.'}">안녕하세요! 러닝 초보입니다. 함께 달리고 싶어요~!</p>
                </div>
                <div class="join-request-card__actions">
                    <button type="button" class="btn-reject" th:data-request-id="${request.joinRequestId}">
                        거절
                    </button>
                    <button type="button" class="btn-approve" th:data-request-id="${request.joinRequestId}">
                        승인
                    </button>
                </div>
            </article>
        </section>

        <!-- 빈 상태 (신청자가 없을 때) -->
        <div class="empty-state" id="emptyState" style="display: none;">
            <svg class="empty-state__icon" width="80" height="80" viewBox="0 0 80 80" fill="none">
                <rect x="10" y="10" width="60" height="50" rx="4" fill="#E0E0E0"/>
                <rect x="20" y="20" width="40" height="30" rx="2" fill="#F5F5F5"/>
                <path d="M30 35H50M30 40H45M30 45H50" stroke="#999" stroke-width="2" stroke-linecap="round"/>
                <circle cx="65" cy="15" r="8" fill="#FF4444"/>
                <path d="M61 15L69 15M65 11L65 19" stroke="white" stroke-width="2" stroke-linecap="round"/>
            </svg>
            <p class="empty-state__text">현재 승인 대기 중인 신청자가 없습니다.</p>
        </div>
    </main>

</div>

<div th:replace="~{common/bottom-nav :: bottomNav}"></div>

<input type="hidden" id="crewId" th:value="${crewId}">

<script src="/js/api-common.js" th:src="@{/js/api-common.js}"></script>
<script th:src="@{/js/crew/crewJoinRequestList.js}"></script>

</body>
</html>

