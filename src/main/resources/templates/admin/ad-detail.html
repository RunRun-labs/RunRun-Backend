<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
    />
    <title>RunRun Admin | 광고 상세</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fugaz+One&family=Nunito+Sans:wght@400;600;700;800;900&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="/css/admin-layout.css"
      th:href="@{/css/admin-layout.css}"
    />
    <link
      rel="stylesheet"
      href="/css/ad-detail.css"
      th:href="@{/css/ad-detail.css}"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  </head>
  <body>
    <script src="/js/admin-common.js" th:src="@{/js/admin-common.js}"></script>
    <!-- 레이아웃 적용 -->
    <div th:replace="~{admin/layout :: adminLayout(~{::.ad-detail-content})}">
      <!-- 컨텐츠 영역 -->
      <div class="ad-detail-content ad-detail-container">
        <div class="ad-detail-card">
          <div class="page-header">
            <h1 class="page-title">광고 상세</h1>
            <div style="display: flex; gap: 12px;">
              <button 
                type="button" 
                class="create-button" 
                onclick="window.location.href='/admin/ad/update/' + adId"
              >
                수정하기
              </button>
              <button 
                type="button" 
                class="create-button" 
                style="background: #ff4444;"
                onclick="deleteAd()"
              >
                삭제하기
              </button>
              <button 
                type="button" 
                class="create-button" 
                style="background: var(--text-secondary);"
                onclick="window.location.href='/admin/ad/inquiry'"
              >
                목록으로
              </button>
            </div>
          </div>

          <!-- 광고 기본 정보 -->
          <div class="info-section">
            <h2 class="section-title">기본 정보</h2>
            <div class="info-grid">
              <div class="info-item">
                <label class="info-label">광고명</label>
                <div class="info-value" id="adName">-</div>
              </div>
              <div class="info-item">
                <label class="info-label">이미지</label>
                <div class="info-value">
                  <img id="adImage" src="" alt="광고 이미지" style="max-width: 300px; max-height: 200px; border-radius: 8px;" />
                </div>
              </div>
              <div class="info-item info-item-full">
                <label class="info-label">리다이렉트 URL</label>
                <div class="info-value" id="adRedirectUrl">-</div>
              </div>
            </div>
          </div>

          <!-- Placement 통계 -->
          <div class="info-section">
            <h2 class="section-title">Placement 통계</h2>
            <div class="info-grid">
              <div class="info-item">
                <label class="info-label">총 Placement 수</label>
                <div class="info-value" id="totalPlacementCount">0</div>
              </div>
              <div class="info-item">
                <label class="info-label">총 노출 수</label>
                <div class="info-value" id="totalPlacementImpressions">0</div>
              </div>
              <div class="info-item">
                <label class="info-label">총 클릭 수</label>
                <div class="info-value" id="totalPlacementClicks">0</div>
              </div>
              <div class="info-item">
                <label class="info-label">CTR</label>
                <div class="info-value" id="totalPlacementCtr">0.00%</div>
              </div>
            </div>
          </div>

          <!-- 통계 필터 -->
          <div class="stats-section">
            <div class="stats-header">
              <h2 class="section-title">통계</h2>
              <div class="stats-filter">
                <label class="filter-label">기간</label>
                <select id="rangeFilter" class="filter-select">
                  <option value="D7">7일</option>
                  <option value="D30" selected>30일</option>
                  <option value="D90">90일</option>
                </select>
              </div>
            </div>

            <!-- 통계 요약 -->
            <div class="stats-summary">
              <div class="stat-card">
                <div class="stat-label">노출 수</div>
                <div class="stat-value" id="totalImpressions">0</div>
              </div>
              <div class="stat-card">
                <div class="stat-label">클릭 수</div>
                <div class="stat-value" id="totalClicks">0</div>
              </div>
              <div class="stat-card">
                <div class="stat-label">CTR</div>
                <div class="stat-value" id="totalCtr">0.00%</div>
              </div>
            </div>

            <!-- 날짜별 추이 차트 -->
            <div class="chart-container">
              <h3 class="chart-title">날짜별 추이</h3>
              <canvas id="dailyChart"></canvas>
            </div>

            <!-- 슬롯별 집계 차트 -->
            <div class="chart-container">
              <h3 class="chart-title">슬롯별 집계</h3>
              <canvas id="slotChart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script
      src="/js/ad-detail.js"
      th:src="@{/js/ad-detail.js}"
    ></script>
  </body>
</html>

