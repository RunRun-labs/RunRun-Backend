<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
    />
    <title>RUNRUN | 코스 만들기</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fugaz+One&display=swap"
      rel="stylesheet"
    />
    <script src="/js/api-common.js" th:src="@{/js/api-common.js}"></script>
<script
      src="//dapi.kakao.com/v2/maps/sdk.js?appkey=477a1cea9ecc7c2b3e69f3540a3986b4&libraries=services"
      th:src="@{//dapi.kakao.com/v2/maps/sdk.js?appkey=477a1cea9ecc7c2b3e69f3540a3986b4&libraries=services}"
    ></script>
    <link
      rel="stylesheet"
      href="/css/courseCreate.css"
      th:href="@{/css/courseCreate.css}"
    />
  </head>
  <body>
    <div class="page">
      <!-- Header -->
      <header class="header">
        <button type="button" class="back-button" aria-label="뒤로가기" onclick="history.back()">
          <img th:src="@{/img/icons/back.svg}" src="/img/icons/back.svg" alt="뒤로가기">
        </button>
        <h1 class="header-title">코스 만들기</h1>
      </header>

      <!-- Main Content -->
      <main class="course-main">
        <form
          class="course-form"
          th:action="@{/api/courses}"
          action="/api/courses"
          method="post"
          id="courseForm"
          enctype="multipart/form-data"
        >
          <!-- Title Field -->
          <div class="form-field" data-field="title">
            <label class="field-label">제목</label>
            <input
              type="text"
              name="title"
              class="field-input"
              placeholder="제목을 입력하세요"
              maxlength="50"
            />
            <p class="field-error" data-error-for="title"></p>
          </div>

          <!-- Content Field -->
          <div class="form-field" data-field="description">
            <label class="field-label">내용</label>
            <textarea
              name="description"
              class="field-textarea"
              placeholder="내용을 입력하세요"
              rows="8"
              maxlength="500"
            ></textarea>
            <p class="field-error" data-error-for="description"></p>
          </div>

          <!-- Route Builder Launcher -->
          <div class="form-field">
            <label class="field-label">코스</label>
            <p class="helper-text">
              아래 버튼을 눌러 자동/수동 편집 화면에서 경로를 완성해 주세요.
              완료 후 이 화면으로 돌아오면 정보가 채워집니다.
            </p>
            <div class="route-launcher">
              <button type="button" id="autoRouteBtn" class="mode-button">
                자동 등록
              </button>
              <button type="button" id="manualRouteBtn" class="mode-button">
                수동 등록
              </button>
            </div>
            <div class="route-summary" id="routeSummary">
              아직 선택된 코스가 없습니다.
            </div>
            <div class="map-container compact" id="mapPreview"></div>
            <p class="field-error" data-error-for="path"></p>
            <input type="hidden" name="path" id="pathInput" />
            <input type="hidden" name="distanceM" id="distanceMInput" />
            <input type="hidden" name="startLat" id="startLatInput" />
            <input type="hidden" name="startLng" id="startLngInput" />
            <input type="hidden" name="address" id="addressInput" />
            <input
              type="hidden"
              name="courseRegisterType"
              id="courseRegisterTypeInput"
            />
          </div>

          <!-- Image Upload Section -->
          <div class="form-field">
            <label class="field-label">이미지</label>
            <div class="image-upload-area" id="imageUploadArea">
              <div class="upload-placeholder" id="uploadPlaceholder">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M23 19C23 19.5304 22.7893 20.0391 22.4142 20.4142C22.0391 20.7893 21.5304 21 21 21H3C2.46957 21 1.96086 20.7893 1.58579 20.4142C1.21071 20.0391 1 19.5304 1 19V8C1 7.46957 1.21071 6.96086 1.58579 6.58579C1.96086 6.21071 2.46957 6 3 6H7L9 3H15L17 6H21C21.5304 6 22.0391 6.21071 22.4142 6.58579C22.7893 6.96086 23 7.46957 23 8V19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M12 17C14.2091 17 16 15.2091 16 13C16 10.7909 14.2091 9 12 9C9.79086 9 8 10.7909 8 13C8 15.2091 9.79086 17 12 17Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span class="upload-text">이미지 넣기</span>
              </div>
              <div class="image-preview" id="imagePreview"></div>
              <input
                type="file"
                name="image"
                id="imageInput"
                accept="image/*"
                class="image-input"
              />
            </div>
          </div>
        </form>
      </main>

      <!-- Bottom Navigation -->
      <div th:replace="~{common/bottom-nav :: bottomNav}"></div>
    </div>

    <!-- 작성 완료 버튼 (하단 고정) -->
    <button
      class="submit-button"
      type="submit"
      id="stickyCreateBtn"
      form="courseForm"
    >
      <span class="button-text">작성 완료</span>
      <span class="button-spinner"></span>
    </button>

    <script src="/js/courseCreate.js" th:src="@{/js/courseCreate.js}"></script>
  
</body>
</html>
