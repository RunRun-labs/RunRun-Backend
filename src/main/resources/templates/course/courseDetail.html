<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
    />
    <title>RUNRUN | 코스 상세보기</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fugaz+One&family=Nunito+Sans:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <script src="/js/api-common.js" th:src="@{/js/api-common.js}"></script>
<script
      src="//dapi.kakao.com/v2/maps/sdk.js?appkey=477a1cea9ecc7c2b3e69f3540a3986b4&libraries=services"
      th:src="@{//dapi.kakao.com/v2/maps/sdk.js?appkey=477a1cea9ecc7c2b3e69f3540a3986b4&libraries=services}"
    ></script>
    <link
      rel="stylesheet"
      href="/css/courseDetail.css"
      th:href="@{/css/courseDetail.css}"
    />
    <link
      rel="stylesheet"
      href="/css/notification-toast.css"
      th:href="@{/css/notification-toast.css}"
    />
  </head>
  <body>
    <div class="page">
      <!-- Header -->
      <header class="course-header">
        <button
          class="back-button"
          type="button"
          aria-label="뒤로가기"
          onclick="history.back()"
        >
          <img
            th:src="@{/img/icons/back.svg}"
            src="/img/icons/back.svg"
            alt="뒤로가기 아이콘"
          />
        </button>
        <h1 class="page-title">코스 상세보기</h1>
      </header>

      <!-- Course Image Hero (크루 상세보기처럼) -->
      <section class="course-hero">
        <div
          class="course-hero__image-wrapper"
          id="courseImageContainer"
          style="display: none"
        >
          <img id="courseImage" alt="코스 이미지" class="course-hero__image" />
        </div>
      </section>

      <!-- Main Content -->
      <main class="course-content" id="courseContent">
        <!-- Course Map -->
        <div class="form-field">
          <label class="field-label">코스</label>
          <div class="map-container" id="map"></div>
        </div>

        <!-- 지도 모달 (visibility: hidden으로 DOM에 미리 렌더링) -->
        <div class="map-modal-overlay" id="mapModal" style="visibility: hidden; opacity: 0;">
          <div class="map-modal-content">
            <div class="map-modal-header">
              <h2 class="map-modal-title">코스 지도</h2>
              <button
                class="map-modal-close"
                type="button"
                id="closeMapModal"
                aria-label="닫기"
              >
                ×
              </button>
            </div>
            <div class="map-modal-body">
              <div class="map-modal-container" id="mapModal-map"></div>
            </div>
          </div>
        </div>

        <!-- Title Field -->
        <div class="form-field">
          <label class="field-label">제목</label>
          <input type="text" class="field-input" id="courseTitle" readonly />
        </div>

        <!-- Content Field -->
        <div class="form-field">
          <label class="field-label">내용</label>
          <textarea
            class="field-textarea"
            id="courseDescription"
            readonly
          ></textarea>
        </div>

        <!-- Distance Field -->
        <div class="form-field">
          <label class="field-label">거리</label>
          <input type="text" class="field-input" id="courseDistance" readonly />
        </div>

        <!-- Location Field -->
        <div class="form-field">
          <label class="field-label">위치</label>
          <input type="text" class="field-input" id="courseAddress" readonly />
        </div>

        <!-- Author Field -->
        <div class="form-field">
          <label class="field-label">작성자</label>
          <input type="text" class="field-input" id="courseAuthor" readonly />
        </div>

        <!-- Created Date Field -->
        <div class="form-field">
          <label class="field-label">작성일자</label>
          <input
            type="text"
            class="field-input"
            id="courseCreatedAt"
            readonly
          />
        </div>

        <!-- Like/Favorite Actions -->
        <div class="course-like-actions">
          <button
            class="action-icon heart-icon"
            type="button"
            id="likeBtn"
            aria-label="좋아요"
          >
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
              <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
            </svg>
            <span class="action-count" id="likeCount">0</span>
          </button>
          <button
            class="action-icon star-icon"
            type="button"
            id="favoriteBtn"
            aria-label="즐겨찾기"
          >
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
              <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
            </svg>
            <span class="action-count" id="favoriteCount">0</span>
          </button>
          <button
            class="action-icon siren-icon"
            type="button"
            id="sirenBtn"
            aria-label="신고하기"
          >
            <img src="/img/siren.svg" th:src="@{/img/siren.svg}" alt="신고하기 아이콘" />
            <span>신고하기</span>
          </button>
        </div>

        <!-- Action Buttons (Edit/Delete) -->
        <div class="course-actions" id="courseActions" style="display: none">
          <button class="edit-button" type="button" id="editBtn">
            수정하기
          </button>
          <button class="delete-button" type="button" id="deleteBtn">
            삭제하기
          </button>
        </div>
      </main>

      <!-- Siren Modal -->
      <div class="modal-overlay" id="sirenModal" style="display: none">
        <div class="modal-content">
          <div class="modal-header">
            <h2 class="modal-title">코스 신고하기</h2>
            <button
              class="modal-close"
              type="button"
              id="closeSirenModal"
              aria-label="닫기"
            >
              ×
            </button>
          </div>
          <div class="modal-body">
            <p class="modal-description">
              부적절한 내용이 있다면 신고해주세요. 신고 사유를 자세히
              입력해주시면 더 빠르게 처리할 수 있습니다.
            </p>
            <div class="form-field">
              <label class="field-label" for="sirenDescription"
                >신고 사유</label
              >
              <textarea
                class="field-textarea"
                id="sirenDescription"
                placeholder="신고 사유를 입력해주세요 (10자 이상 500자 이하)"
                rows="5"
              ></textarea>
              <p
                class="field-error"
                id="sirenDescriptionError"
                style="display: none"
              ></p>
            </div>
          </div>
          <div class="modal-footer">
            <button
              class="modal-button cancel-button"
              type="button"
              id="cancelSirenBtn"
            >
              취소
            </button>
            <button
              class="modal-button submit-button"
              type="button"
              id="submitSirenBtn"
            >
              신고하기
            </button>
          </div>
        </div>
      </div>

      <!-- Select Confirm Bar (모집글에서 코스 선택 모드로 들어온 경우만 표시) -->
      <div
        class="select-confirm-bar"
        id="selectConfirmBar"
        style="display: none"
      >
        <button
          class="select-confirm-button"
          type="button"
          id="selectConfirmBtn"
        >
          확인
        </button>
      </div>

      <!-- Bottom Navigation -->
      <div th:replace="~{common/bottom-nav :: bottomNav}"></div>
    </div>

    <!-- Course ID for JavaScript -->
    <script th:inline="javascript">
      /*<![CDATA[*/
      const courseId = /*[[${courseId}]]*/ null;
      /*]]>*/
    </script>

    <script
      src="/js/notification-common.js"
      th:src="@{/js/notification-common.js}"
    ></script>
    <script src="/js/courseDetail.js" th:src="@{/js/courseDetail.js}"></script>
  
</body>
</html>
