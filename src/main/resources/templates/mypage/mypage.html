<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <meta
            name="viewport"
            content="width=device-width, initial-scale=1, maximum-scale=1"
    />
    <title>RUNRUN | My Page</title>
    <link rel="preconnect" href="https://fonts.googleapis.com"/>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
    <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fugaz+One&display=swap"
            rel="stylesheet"
    />
    <link
            rel="stylesheet"
            href="/css/mypage.css"
            th:href="@{/css/mypage.css}"
    />
    <link rel="stylesheet" href="/css/notification-toast.css"
          th:href="@{/css/notification-toast.css}">
</head>
<body class="mypage-body">
<main class="page mypage-page">
    <header class="mypage-header">
        <h1 class="mypage-logo">MYPAGE</h1>
        <button class="icon-button settings-button" type="button" aria-label="설정" data-role="settings">
            <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g clip-path="url(#clip0_149_3526)">
                    <path d="M20.0001 25.0001C22.7615 25.0001 25.0001 22.7615 25.0001 20.0001C25.0001 17.2387 22.7615 15.0001 20.0001 15.0001C17.2387 15.0001 15.0001 17.2387 15.0001 20.0001C15.0001 22.7615 17.2387 25.0001 20.0001 25.0001Z"
                          stroke="#1E1E1E" stroke-width="3.5" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M32.3334 25.0001C32.1116 25.5028 32.0454 26.0604 32.1434 26.6011C32.2414 27.1417 32.4992 27.6406 32.8834 28.0334L32.9834 28.1334C33.2933 28.443 33.5392 28.8106 33.7069 29.2153C33.8747 29.6199 33.961 30.0537 33.961 30.4917C33.961 30.9298 33.8747 31.3636 33.7069 31.7682C33.5392 32.1729 33.2933 32.5405 32.9834 32.8501C32.6738 33.16 32.3062 33.4059 31.9015 33.5736C31.4969 33.7414 31.0631 33.8277 30.6251 33.8277C30.187 33.8277 29.7533 33.7414 29.3486 33.5736C28.944 33.4059 28.5763 33.16 28.2667 32.8501L28.1667 32.7501C27.7739 32.3659 27.2751 32.1081 26.7344 32.0101C26.1937 31.912 25.6361 31.9782 25.1334 32.2001C24.6405 32.4113 24.2201 32.7622 23.9239 33.2093C23.6278 33.6565 23.4689 34.1804 23.4667 34.7167V35.0001C23.4667 35.8841 23.1156 36.732 22.4904 37.3571C21.8653 37.9822 21.0175 38.3334 20.1334 38.3334C19.2494 38.3334 18.4015 37.9822 17.7764 37.3571C17.1513 36.732 16.8001 35.8841 16.8001 35.0001V34.8501C16.7872 34.2984 16.6086 33.7634 16.2876 33.3146C15.9666 32.8658 15.518 32.5239 15.0001 32.3334C14.4974 32.1116 13.9398 32.0454 13.3991 32.1434C12.8584 32.2414 12.3595 32.4992 11.9667 32.8834L11.8667 32.9834C11.5572 33.2933 11.1895 33.5392 10.7849 33.7069C10.3802 33.8747 9.94647 33.961 9.50841 33.961C9.07036 33.961 8.63661 33.8747 8.23195 33.7069C7.82729 33.5392 7.45966 33.2933 7.15008 32.9834C6.84016 32.6738 6.5943 32.3062 6.42655 31.9015C6.2588 31.4969 6.17246 31.0631 6.17246 30.6251C6.17246 30.187 6.2588 29.7533 6.42655 29.3486C6.5943 28.944 6.84016 28.5763 7.15008 28.2667L7.25008 28.1667C7.63431 27.7739 7.89206 27.2751 7.99009 26.7344C8.08812 26.1937 8.02194 25.6361 7.80008 25.1334C7.58881 24.6405 7.23801 24.2201 6.79086 23.9239C6.34371 23.6278 5.81973 23.4689 5.28341 23.4667H5.00008C4.11603 23.4667 3.26818 23.1156 2.64306 22.4904C2.01794 21.8653 1.66675 21.0175 1.66675 20.1334C1.66675 19.2494 2.01794 18.4015 2.64306 17.7764C3.26818 17.1513 4.11603 16.8001 5.00008 16.8001H5.15008C5.70174 16.7872 6.23676 16.6086 6.68558 16.2876C7.1344 15.9666 7.47627 15.518 7.66675 15.0001C7.88861 14.4974 7.95479 13.9398 7.85675 13.3991C7.75872 12.8584 7.50098 12.3595 7.11675 11.9667L7.01675 11.8667C6.70683 11.5572 6.46096 11.1895 6.29322 10.7849C6.12547 10.3802 6.03913 9.94647 6.03913 9.50841C6.03913 9.07036 6.12547 8.63661 6.29322 8.23195C6.46096 7.82729 6.70683 7.45966 7.01675 7.15008C7.32632 6.84016 7.69395 6.5943 8.09861 6.42655C8.50327 6.2588 8.93703 6.17246 9.37508 6.17246C9.81313 6.17246 10.2469 6.2588 10.6515 6.42655C11.0562 6.5943 11.4238 6.84016 11.7334 7.15008L11.8334 7.25008C12.2262 7.63431 12.7251 7.89206 13.2658 7.99009C13.8064 8.08812 14.3641 8.02194 14.8667 7.80008H15.0001C15.493 7.58881 15.9134 7.23801 16.2096 6.79086C16.5057 6.34371 16.6646 5.81973 16.6667 5.28341V5.00008C16.6667 4.11603 17.0179 3.26818 17.6431 2.64306C18.2682 2.01794 19.116 1.66675 20.0001 1.66675C20.8841 1.66675 21.732 2.01794 22.3571 2.64306C22.9822 3.26818 23.3334 4.11603 23.3334 5.00008V5.15008C23.3356 5.68639 23.4945 6.21037 23.7906 6.65752C24.0867 7.10467 24.5071 7.45548 25.0001 7.66675C25.5028 7.88861 26.0604 7.95479 26.6011 7.85675C27.1417 7.75872 27.6406 7.50098 28.0334 7.11675L28.1334 7.01675C28.443 6.70683 28.8106 6.46096 29.2153 6.29322C29.6199 6.12547 30.0537 6.03913 30.4917 6.03913C30.9298 6.03913 31.3636 6.12547 31.7682 6.29322C32.1729 6.46096 32.5405 6.70683 32.8501 7.01675C33.16 7.32632 33.4059 7.69395 33.5736 8.09861C33.7414 8.50327 33.8277 8.93703 33.8277 9.37508C33.8277 9.81313 33.7414 10.2469 33.5736 10.6515C33.4059 11.0562 33.16 11.4238 32.8501 11.7334L32.7501 11.8334C32.3659 12.2262 32.1081 12.7251 32.0101 13.2658C31.912 13.8064 31.9782 14.3641 32.2001 14.8667V15.0001C32.4113 15.493 32.7622 15.9134 33.2093 16.2096C33.6565 16.5057 34.1804 16.6646 34.7167 16.6667H35.0001C35.8841 16.6667 36.732 17.0179 37.3571 17.6431C37.9822 18.2682 38.3334 19.116 38.3334 20.0001C38.3334 20.8841 37.9822 21.732 37.3571 22.3571C36.732 22.9822 35.8841 23.3334 35.0001 23.3334H34.8501C34.3138 23.3356 33.7898 23.4945 33.3426 23.7906C32.8955 24.0867 32.5447 24.5071 32.3334 25.0001Z"
                          stroke="#1E1E1E" stroke-width="3.5" stroke-linecap="round" stroke-linejoin="round"/>
                </g>
                <defs>
                    <clipPath id="clip0_149_3526">
                        <rect width="40" height="40" fill="white"/>
                    </clipPath>
                </defs>
            </svg>
        </button>
    </header>

    <section class="profile-summary">
        <div class="profile-row">

            <!-- 좌측: 프로필 이미지 -->
            <div class="profile-avatar" data-role="avatar-click">
                <img
                        class="avatar-img"
                        data-role="profile-preview"
                        alt="프로필 이미지"
                        hidden
                />
                <span
                        class="avatar-initial"
                        data-role="profile-initial"
                ></span>
            </div>

            <input
                    type="file"
                    id="profileImageInput"
                    accept="image/*"
                    hidden
            />


            <!-- 중앙: 티어/레이팅/포인트 정보 -->
            <div class="profile-text profile-center">
                <div class="profile-meta">
                    <div class="tier-section">
                        <span class="tier-label">티어 :</span>
                        <div class="tier-display" data-role="tier-click" style="cursor: pointer;">
                            <img src="/img/tier/Rabbit.png" alt="토끼" class="tier-image" id="tierImage"
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';">
                            <span class="tier-text" id="tierText">🐰</span>
                        </div>
                    </div>
                    <div class="rating-section">
                        <span class="rating-label">레이팅:</span>
                        <span class="rating-value" id="ratingValue">-</span>
                    </div>
                    <div class="point-section">
                        <span class="point-label">포인트:</span>
                        <span class="point-value" th:text="${pointBalance != null ? pointBalance : '-'}">-</span>
                    </div>
                </div>
            </div>

            <!-- 우측: 쿠폰함/친구/프로필 설정 버튼 -->
            <div class="profile-actions-vertical">
                <button class="action-button-vertical" type="button" data-role="coupons">쿠폰함</button>
                <button class="action-button-vertical" type="button" data-role="friends">친구</button>
                <button class="action-button-vertical" type="button" data-role="profile-settings">프로필 설정</button>
            </div>

        </div>
    </section>

    <section class="my-content-section">
        <div class="my-content-buttons">
            <button class="my-content-button" type="button" data-role="challenge">
                <span class="button-icon">🏅</span>
                <span class="button-text">챌린지</span>
            </button>
            <button class="my-content-button" type="button" data-role="my-courses">
                <span class="button-icon">📍</span>
                <span class="button-text">내 코스</span>
            </button>
            <button class="my-content-button" type="button" data-role="my-posts">
                <span class="button-icon">📝</span>
                <span class="button-text">내 게시글</span>
            </button>
        </div>
    </section>

    <!-- 내 코스 모달 -->
    <div class="course-modal" id="courseModal" data-role="course-modal">
        <div class="course-modal-overlay" data-role="course-modal-overlay"></div>
        <div class="course-modal-content">
            <div class="course-modal-header">
                <h2 class="course-modal-title">내 코스</h2>
                <button class="course-modal-close" type="button" data-role="course-modal-close" aria-label="닫기">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                              stroke-linejoin="round"/>
                    </svg>
                </button>
            </div>
            <div class="course-modal-options">
                <button class="course-modal-option" type="button" data-role="course-option" data-type="liked">
                    <span class="option-icon">❤️</span>
                    <span class="option-text">좋아요 한 코스</span>
                    <svg class="option-arrow" width="16" height="16" viewBox="0 0 16 16" fill="none"
                         xmlns="http://www.w3.org/2000/svg">
                        <path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                              stroke-linejoin="round"/>
                    </svg>
                </button>
                <button class="course-modal-option" type="button" data-role="course-option" data-type="favorited">
                    <span class="option-icon">⭐</span>
                    <span class="option-text">즐겨찾기 한 코스</span>
                    <svg class="option-arrow" width="16" height="16" viewBox="0 0 16 16" fill="none"
                         xmlns="http://www.w3.org/2000/svg">
                        <path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                              stroke-linejoin="round"/>
                    </svg>
                </button>
                <button class="course-modal-option" type="button" data-role="course-option" data-type="my">
                    <span class="option-icon">📌</span>
                    <span class="option-text">내가 등록한 코스</span>
                    <svg class="option-arrow" width="16" height="16" viewBox="0 0 16 16" fill="none"
                         xmlns="http://www.w3.org/2000/svg">
                        <path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                              stroke-linejoin="round"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- 챌린지 모달 -->
    <div class="course-modal" id="challengeModal" data-role="challenge-modal">
        <div class="course-modal-overlay" data-role="challenge-modal-overlay"></div>
        <div class="course-modal-content">
            <div class="course-modal-header">
                <h2 class="course-modal-title">챌린지</h2>
                <button class="course-modal-close" type="button" data-role="challenge-modal-close" aria-label="닫기">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                              stroke-linejoin="round"/>
                    </svg>
                </button>
            </div>
            <div class="course-modal-options">
                <button class="course-modal-option" type="button" data-role="challenge-option" data-type="active">
                    <span class="option-icon">🏃‍♂️</span>
                    <span class="option-text">진행중 챌린지</span>
                    <svg class="option-arrow" width="16" height="16" viewBox="0 0 16 16" fill="none"
                         xmlns="http://www.w3.org/2000/svg">
                        <path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                              stroke-linejoin="round"/>
                    </svg>
                </button>
                <button class="course-modal-option" type="button" data-role="challenge-option" data-type="ended">
                    <span class="option-icon">🏁</span>
                    <span class="option-text">종료된 챌린지</span>
                    <svg class="option-arrow" width="16" height="16" viewBox="0 0 16 16" fill="none"
                         xmlns="http://www.w3.org/2000/svg">
                        <path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                              stroke-linejoin="round"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <section class="run-list-section">
        <div class="run-list-header">
            <h2 class="run-list-title">러닝 기록</h2>
            <button class="date-search-button" type="button" id="dateSearchButton" aria-label="날짜 검색">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M8 2V6M16 2V6M3 10H21M5 4H19C20.1046 4 21 4.89543 21 6V20C21 21.1046 20.1046 22 19 22H5C3.89543 22 3 21.1046 3 20V6C3 4.89543 3.89543 4 5 4Z"
                          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span id="dateSearchLabel">날짜 검색</span>
            </button>
        </div>
        <section class="run-list" data-role="run-list">
            <!-- 러닝 기록 카드는 JavaScript로 동적 생성 -->
        </section>

        <!-- 빈 상태 UI -->
        <div class="run-list-empty" id="runListEmpty" hidden>
            <div class="empty-text-large">텅~</div>
            <div class="empty-text-small">이번 주 러닝 기록이 없어요</div>
        </div>
    </section>
</main>

<!-- 삭제 확인 모달 -->
<div class="modal-overlay" id="deleteRecordModal" hidden>
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="modal-title">러닝 기록 삭제</h2>
            <button class="modal-close" type="button" aria-label="닫기" data-role="close-delete-modal">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                          stroke-linejoin="round"/>
                </svg>
            </button>
        </div>
        <div class="modal-body">
            <p class="delete-confirm-message">정말 이 러닝 기록을 삭제하시겠습니까?</p>
            <p class="delete-warning-message">삭제된 기록은 복구할 수 없습니다.</p>
        </div>
        <div class="modal-footer">
            <button class="modal-cancel-button" type="button" data-role="cancel-delete-record">취소</button>
            <button class="modal-confirm-button" type="button" data-role="confirm-delete-record">삭제</button>
        </div>
    </div>
</div>

<!-- 이미지 모달 -->
<div class="image-modal-overlay" id="imageModal" hidden>
    <div class="image-modal-content">
        <button class="image-modal-close" type="button" aria-label="닫기" data-role="close-image-modal">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round"/>
            </svg>
        </button>
        <img class="image-modal-img" id="imageModalImg" src="" alt="코스 이미지"/>
    </div>
</div>

<!-- 티어/레이팅 모달 -->
<div class="course-modal" id="tierRatingModal" data-role="tier-rating-modal" hidden>
    <div class="course-modal-overlay" data-role="tier-rating-modal-overlay"></div>
    <div class="course-modal-content">
        <div class="course-modal-header">
            <h2 class="course-modal-title">거리별 티어 & 레이팅</h2>
            <button class="course-modal-close" type="button" data-role="tier-rating-modal-close" aria-label="닫기">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                          stroke-linejoin="round"/>
                </svg>
            </button>
        </div>
        <div class="course-modal-options" id="tierRatingList">
            <!-- 거리별 티어/레이팅은 JavaScript로 동적 생성 -->
            <div style="padding: 20px; text-align: center; color: #999;">
                <p>로딩 중...</p>
            </div>
        </div>
    </div>
</div>

<!-- 달력 모달 -->
<div class="calendar-modal-overlay" id="calendarModal" hidden>
    <div class="calendar-modal-content">
        <div class="calendar-modal-header">
            <h2 class="calendar-modal-title">날짜 선택</h2>
            <button class="calendar-modal-close" type="button" aria-label="닫기" data-role="close-calendar-modal">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                          stroke-linejoin="round"/>
                </svg>
            </button>
        </div>
        <div class="calendar-container">
            <div class="calendar-month-header">
                <button class="calendar-nav-button" type="button" id="calendarPrevMonth" aria-label="이전 달">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                              stroke-linejoin="round"/>
                    </svg>
                </button>
                <div class="calendar-month-year" id="calendarMonthYear">2026년 1월</div>
                <button class="calendar-nav-button" type="button" id="calendarNextMonth" aria-label="다음 달">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                              stroke-linejoin="round"/>
                    </svg>
                </button>
            </div>
            <div class="calendar-weekdays">
                <div class="calendar-weekday">일</div>
                <div class="calendar-weekday">월</div>
                <div class="calendar-weekday">화</div>
                <div class="calendar-weekday">수</div>
                <div class="calendar-weekday">목</div>
                <div class="calendar-weekday">금</div>
                <div class="calendar-weekday">토</div>
            </div>
            <div class="calendar-days" id="calendarDays">
                <!-- 달력 날짜는 JavaScript로 동적 생성 -->
            </div>
        </div>
        <div class="calendar-modal-footer">
            <button class="calendar-reset-button" type="button" id="calendarResetButton">초기화</button>
        </div>
    </div>
</div>

<template id="bottomNavTemplate">
    <nav class="bottom-nav" aria-label="하단 메뉴">
        <a class="nav-item" th:href="@{/chat}" href="/chat">
            <img
                    src="http://localhost:3845/assets/3ca81eaa50aaf4304e5454034789cf398897e16f.svg"
                    alt=""
                    aria-hidden="true"
            />
            <span>chat</span>
        </a>
        <a class="nav-item" th:href="@{/feed}" href="/feed">
            <img
                    src="http://localhost:3845/assets/a25ca98a797a195cf0014d33755d97160983a834.svg"
                    alt=""
                    aria-hidden="true"
            />
            <span>feed</span>
        </a>
        <a class="nav-item" th:href="@{/}" href="/">
            <img
                    src="http://localhost:3845/assets/6d060744ca344e07264a3340d1ce76267f035268.svg"
                    alt=""
                    aria-hidden="true"
            />
            <span>home</span>
        </a>
        <a class="nav-item" th:href="@{/match}" href="/match">
            <img
                    src="http://localhost:3845/assets/a1c3341d0388b5ec41a25350c4e525c869160bdd.svg"
                    alt=""
                    aria-hidden="true"
            />
            <span>match</span>
        </a>
        <a class="nav-item" th:href="@{/my}" href="/my">
            <img
                    src="http://localhost:3845/assets/1894082a888c5c07d733295ec6a54ed9b0711586.svg"
                    alt=""
                    aria-hidden="true"
            />
            <span>my</span>
        </a>
    </nav>
</template>

<div
        id="bottomNavMount"
        th:replace="~{common/bottom-nav :: bottomNav}"
></div>

<script src="/js/notification-common.js" th:src="@{/js/notification-common.js}"></script>
<script src="/js/mypage.js" th:src="@{/js/mypage.js}"></script>
</body>
</html>
