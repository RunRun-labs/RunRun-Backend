<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8"/>
  <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
  />
  <title>RUNRUN | 채팅방</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fugaz+One&display=swap"
      rel="stylesheet"
  />
  <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
  <link rel="stylesheet" href="/css/chat1.css" th:href="@{/css/chat1.css}">
</head>
<body>
<div class="chat-page">
  <!-- 헤더 -->
  <header class="chat-header">
    <div class="header-container">
      <div class="header-left">
        <button class="back-button" type="button" aria-label="뒤로가기">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M15 18L9 12L15 6" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
        <div class="header-info">
          <h1 class="group-name" id="group-name">한강 러닝 크루</h1>
          <p class="participant-count" id="participant-count">0명 참여중</p>
        </div>
      </div>
      <div class="header-right">
        <button class="header-icon-btn" type="button" aria-label="참여자 목록" id="participant-list-btn">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M10 10C12.7614 10 15 7.76142 15 5C15 2.23858 12.7614 0 10 0C7.23858 0 5 2.23858 5 5C5 7.76142 7.23858 10 10 10Z" fill="white"/>
            <path d="M10 12C5.58172 12 2 13.7909 2 16V20H18V16C18 13.7909 14.4183 12 10 12Z" fill="white"/>
          </svg>
        </button>
        <button class="header-icon-btn" type="button" aria-label="더보기" id="more-menu-btn">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="10" cy="4" r="1.5" fill="white"/>
            <circle cx="10" cy="10" r="1.5" fill="white"/>
            <circle cx="10" cy="16" r="1.5" fill="white"/>
          </svg>
        </button>
      </div>
    </div>
    
    <!-- 러닝 정보 카드 -->
    <div class="running-info-card">
      <div class="info-card-left">
        <span class="offline-badge" id="session-type-badge">🏃 오프라인</span>
        <span class="distance" id="session-distance">0km</span>
      </div>
      <div class="info-card-right">
        <p class="date-time" id="meeting-time">로딩 중...</p>
      </div>
      <div class="info-card-location">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8 0C4.13401 0 1 3.13401 1 7C1 12.5 8 16 8 16C8 16 15 12.5 15 7C15 3.13401 11.866 0 8 0ZM8 9.5C6.61929 9.5 5.5 8.38071 5.5 7C5.5 5.61929 6.61929 4.5 8 4.5C9.38071 4.5 10.5 5.61929 10.5 7C10.5 8.38071 9.38071 9.5 8 9.5Z" fill="white"/>
        </svg>
        <span id="meeting-place">장소 미정</span>
      </div>
    </div>
  </header>

  <!-- 채팅 영역 -->
  <main class="chat-container">
    <div class="chat-messages" id="chat-messages">
      <!-- 메시지들이 여기에 동적으로 추가됨 -->
    </div>

    <!-- 스크롤 버튼 -->
    <button class="scroll-to-bottom" type="button" aria-label="맨 아래로" id="scroll-to-bottom">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M12 5V19M12 19L19 12M12 19L5 12" stroke="#1F2937" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </button>
  </main>

  <!-- 준비 완료 섹션 -->
  <div class="ready-section" id="ready-section">
    <div class="ready-info">
      <div class="ready-avatar">
        <svg width="18" height="21" viewBox="0 0 18 21" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M9 0C4.02944 0 0 4.02944 0 9C0 13.9706 4.02944 18 9 18C13.9706 18 18 13.9706 18 9C18 4.02944 13.9706 0 9 0Z" fill="#FEF3C7"/>
        </svg>
      </div>
      <div class="ready-text">
        <p class="ready-title" id="ready-title">러닝 시작까지 30분</p>
        <p class="ready-subtitle" id="ready-subtitle">0/0명 준비 완료</p>
      </div>
    </div>
    <button class="ready-button" type="button" id="ready-button">✓ 준비완료</button>
  </div>

  <!-- 방장 컨트롤 (런닝 시작) -->
  <div class="host-control-section hidden" id="host-control-section">
    <div class="host-control-content">
      <span>👑 방장입니다</span>
      <button class="start-running-btn" type="button" id="start-running-btn">🏃 런닝 시작</button>
    </div>
  </div>

  <!-- 일반 유저 컨트롤 (런닝 취소) -->
  <div class="user-control-section hidden" id="user-control-section">
    <div class="user-control-content">
      <span>런닝을 취소하시겠습니까?</span>
      <button class="cancel-running-btn" type="button" id="cancel-running-btn">런닝 취소</button>
    </div>
  </div>

  <!-- 메시지 입력 영역 -->
  <div class="message-input-area">
    <button class="attach-button" type="button" aria-label="첨부">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M12 5V19M5 12H19" stroke="#1F2937" stroke-width="2" stroke-linecap="round"/>
      </svg>
    </button>
    <div class="input-wrapper">
      <input 
        type="text" 
        class="message-input" 
        id="message-input"
        placeholder="메시지를 입력하세요"
        aria-label="메시지 입력"
      />
      <button class="emoji-button" type="button" aria-label="이모지">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="10" cy="10" r="8" stroke="#757575" stroke-width="1.5"/>
          <circle cx="7" cy="8" r="1" fill="#757575"/>
          <circle cx="13" cy="8" r="1" fill="#757575"/>
          <path d="M7 13C7 13 8.5 15 10 15C11.5 15 13 13 13 13" stroke="#757575" stroke-width="1.5" stroke-linecap="round"/>
        </svg>
      </button>
    </div>
    <button class="send-button" type="button" id="send-button" aria-label="전송">
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M18 2L9 11M18 2L12 18L9 11M18 2L2 8L9 11" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </button>
  </div>
</div>

<!-- 참여자 목록 모달 -->
<div class="participant-modal-overlay" id="participant-modal-overlay">
  <div class="participant-modal">
    <div class="participant-modal-header">
      <h2 class="participant-modal-title">참여자 목록</h2>
      <button class="participant-modal-close" type="button" id="participant-modal-close" aria-label="닫기">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 4L4 12M4 4L12 12" stroke="#1f2937" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
    </div>
    <div class="participant-ready-status">
      <span class="ready-count" id="participant-ready-count">0</span>
      <span class="ready-total" id="participant-ready-total">/0명 준비완료</span>
    </div>
    <div class="participant-list" id="participant-list">
      <!-- 참여자 목록이 여기에 동적으로 추가됨 -->
    </div>
    <div class="participant-modal-footer">
      <button class="leave-chat-btn" type="button" id="leave-chat-btn">채팅방 나가기</button>
    </div>
  </div>
</div>

<!-- 아래바 -->
<div
    id="bottomNavMount"
    th:replace="~{common/bottom-nav :: bottomNav}"
></div>

<script src="/js/chat1.js" th:src="@{/js/chat1.js}"></script>
</body>
</html>

